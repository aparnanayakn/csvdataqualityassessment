@prefix csvtordf: <https://purl.archive.org/domain/csvtordf#>.
@prefix csvw: <http://www.w3.org/ns/csvw#>
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix xml: <http://www.w3.org/XML/1998/namespace> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix math: <http://www.w3.org/2000/10/swap/math#> .

[R1: (?row rdf:type csvw:Row) (?cell rdf:type csvw:Cell) (?col rdf:type csvw:Column)
(?row csvtordf:hasCell ?cell) (?cell csvtordf:belongsToColumn ?col) 
(?cell csvtordf:hasValue ?value) (?col csvw:datatype ?columndatatype) 
notDType(?value, ?columndatatype) -> (?col csvtordf:hasConstraint ?cnode)
 (?cnode rdf:type csvtordf:SyntaxAccuracy) 
 (?cell csvtordf:expectedDT ?columndatatype) 
(?cell csvtordf:foundDT ?value)]

[R2:  (?row rdf:type csvw:Row) (?cell rdf:type csvw:Cell) (?col rdf:type csvw:Column)
(?row csvtordf:hasCell ?cell) (?cell csvtordf:belongsToColumn ?col) 
(?cell csvtordf:hasValue ?value) (?col csvtordf:mean ?meanvalue) (?col csvtordf:stdDev ?stddevvalue)
 product(?stddevvalue, 3, ?threshold)
difference(?meanvalue ?threshold ?LL) lessThan(?value ?LL) -> 
(?cnode rdf:type csvtordf:Outliers) (?col csvtordf:hasConstraint ?cnode)
(?cell csvtordf:constraintElement ?value)]

[R3: (?row rdf:type csvw:Row) (?cell rdf:type csvw:Cell) (?col rdf:type csvw:Column)
(?row csvtordf:hasCell ?cell) (?cell csvtordf:belongsToColumn ?col)  (?cell csvtordf:hasValue ?value) 
(?col csvtordf:mean ?meanvalue) (?col csvtordf:stdDev ?stddevvalue) product(?stddevvalue, 3, ?threshold)
sum(?meanvalue ?threshold ?UL) greaterThan(?value ?UL) -> (?cnode rdf:type csvtordf:Outliers) (?col csvtordf:hasConstraint ?cnode)
(?cell csvtordf:constraintElement ?value)]

[R4: (?row rdf:type csvw:Row) (?cell rdf:type csvw:Cell) (?col rdf:type csvw:Column)
(?row csvtordf:hasCell ?cell) (?cell csvtordf:belongsToColumn ?col) (?cell csvtordf:hasValue ?value) 
(?col csvtordf:Q1 ?lowerQ) (?col csvtordf:Q3 ?upperQ) difference(?upperQ ?lowerQ ?iqr) product(?iqr 1.5 ?iqrange)  
difference(?lowerQ ?iqrange ?LT) lessThan(?value ?LT)  -> (?cnode rdf:type csvtordf:Outliers) (?col csvtordf:hasConstraint ?cnode)
(?cell csvtordf:constraintElement ?value)]

[R5: (?row rdf:type csvw:Row) (?cell rdf:type csvw:Cell) (?col rdf:type csvw:Column)
(?row csvtordf:hasCell ?cell) (?cell csvtordf:belongsToColumn ?col) (?cell csvtordf:hasValue ?value) 
(?col csvtordf:Q1 ?lowerQ) (?col csvtordf:Q3 ?upperQ) difference(?upperQ ?lowerQ ?iqr) product(?iqr 1.5 ?iqrange)  
sum(?upperQ ?iqrange ?UL) greaterThan(?value ?UL)  -> (?cnode rdf:type csvtordf:Outliers) (?col csvtordf:hasConstraint ?cnode)
(?cell csvtordf:constraintElement ?value)]
